# .gitignore Security Checklist

This document explains what sensitive files are protected from being committed to git.

## âœ… Protected File Categories

### 1. AWS Deployment Files (CONTAINS CREDENTIALS!)
```
âœ… deployment-info.txt
âœ… aws-deployment-info*.txt
âœ… *deployment-info*.txt
```
**Why:** These files contain database passwords, JWT secrets, and AWS resource URLs.

**Generated by:** `scripts/deploy-aws.sh`

### 2. Environment Files
```
âœ… .env
âœ… .env.local
âœ… .env.*.local
âœ… .aws-env
âœ… .env.production.local
âœ… .env.development.local
```
**Why:** Contains API keys, database credentials, and other secrets.

**Safe to commit:** `.env.example`, `.env.production` (templates only)

### 3. AWS Temporary Files
```
âœ… trust-policy.json
âœ… /tmp/trust-policy.json
âœ… /tmp/db-password.txt
```
**Why:** Temporary files created during deployment with sensitive data.

### 4. AWS CDK Generated Files
```
âœ… infrastructure/cdk.out/
âœ… infrastructure/.cdk.staging/
âœ… infrastructure/cdk.context.json
```
**Why:** Generated files that shouldn't be version controlled.

### 5. Database Files
```
âœ… *.sql
âœ… *.dump
âœ… *.backup
âœ… *.bak
âœ… *.sqlite
âœ… *.sqlite3
âœ… *.db
```
**Why:** May contain production data or sensitive information.

### 6. Secrets & Credentials
```
âœ… secrets.json
âœ… credentials.json
âœ… *secret*.txt
âœ… *password*.txt
âœ… *apikey*.txt
```
**Why:** Self-explanatory - contains secrets!

### 7. SSL Certificates & Keys
```
âœ… *.pem
âœ… *.key
âœ… *.crt
âœ… *.cer
âœ… *.p12
```
**Why:** Private keys must never be committed.

### 8. Build Artifacts
```
âœ… frontend/.next/
âœ… frontend/node_modules/
âœ… bin/
âœ… obj/
âœ… *.log
```
**Why:** Generated files that bloat the repository.

### 9. Configuration Files (Development)
```
âœ… appsettings.Development.json
```
**Why:** May contain local database connections or development secrets.

**Safe to commit:** `appsettings.json`, `appsettings.Production.json` (use environment variables for secrets)

## âœ… Files SAFE to Commit (Templates)

These are configuration templates without actual secrets:

```
âœ… .env.example
âœ… .aws-env.example
âœ… railway.json
âœ… vercel.json
âœ… amplify.yml
âœ… apprunner.yaml
âœ… appsettings.json
âœ… appsettings.Production.json
```

**Important:** These files should only contain placeholders, never actual credentials!

## ðŸ” Verify Protection

Test if sensitive files are properly ignored:

```bash
# Create test files
touch deployment-info.txt
touch aws-deployment-info-20251016.txt
touch .aws-env

# Check if they're ignored (should show the .gitignore rule)
git check-ignore -v deployment-info.txt
git check-ignore -v aws-deployment-info-20251016.txt
git check-ignore -v .aws-env

# Clean up
rm deployment-info.txt aws-deployment-info-20251016.txt .aws-env
```

Expected output:
```
.gitignore:511:*deployment-info*.txt    deployment-info.txt
.gitignore:511:*deployment-info*.txt    aws-deployment-info-20251016.txt
.gitignore:514:.aws-env                 .aws-env
```

## âš ï¸ Common Mistakes to Avoid

### 1. Don't Commit .env Files
```bash
# âŒ WRONG - Never do this!
git add .env
git add .env.local

# âœ… CORRECT - Only commit templates
git add .env.example
```

### 2. Don't Commit Deployment Info
```bash
# âŒ WRONG - Contains passwords!
git add aws-deployment-info-20251016.txt

# âœ… CORRECT - Keep these files local only
# They're automatically ignored
```

### 3. Don't Commit Database Credentials
```bash
# âŒ WRONG - Contains connection strings with passwords
# Don't modify appsettings.Development.json with real credentials

# âœ… CORRECT - Use environment variables or Secrets Manager
# Update appsettings.Production.json to reference env vars
```

### 4. Check Before Committing
```bash
# Always check what you're about to commit
git status
git diff --cached

# Look for:
# - Connection strings with passwords
# - API keys
# - JWT secrets
# - Database credentials
```

## ðŸ›¡ï¸ Security Best Practices

### 1. Use Environment Variables
Instead of hardcoding secrets in config files:

```json
// âŒ WRONG
{
  "ConnectionStrings": {
    "DefaultConnection": "Host=prod.db.com;Password=secret123"
  }
}

// âœ… CORRECT
{
  "ConnectionStrings": {
    "DefaultConnection": "" // Set via environment variable
  }
}
```

### 2. Use AWS Secrets Manager (Production)
For production deployments:

```bash
# Store secrets in AWS Secrets Manager
aws secretsmanager create-secret \
  --name signalcopilot/database \
  --secret-string '{"password":"..."}'

# Reference in App Runner environment variables
ConnectionStrings__DefaultConnection=arn:aws:secretsmanager:...
```

### 3. Rotate Credentials Regularly
- Change database passwords quarterly
- Regenerate JWT secrets on security updates
- Rotate API keys every 90 days

### 4. Audit Your Repository
Check if secrets were accidentally committed:

```bash
# Search for potential secrets in git history
git log -S "password" --all
git log -S "secret" --all
git log -S "api_key" --all

# Use tools like git-secrets
git secrets --scan
```

## ðŸ“ Adding New Patterns

If you create new files with sensitive data:

1. Add the pattern to `.gitignore`:
```bash
echo "my-secret-file.txt" >> .gitignore
```

2. Verify it's ignored:
```bash
git check-ignore -v my-secret-file.txt
```

3. If file was already committed, remove it:
```bash
git rm --cached my-secret-file.txt
git commit -m "Remove sensitive file from git"
```

## âœ… Pre-Commit Checklist

Before every commit, verify:

- [ ] No `.env` files (except `.env.example`)
- [ ] No `deployment-info*.txt` files
- [ ] No files with `password`, `secret`, or `apikey` in name
- [ ] No database dump files (`.sql`, `.dump`)
- [ ] No SSL private keys (`.key`, `.pem`)
- [ ] Check `git status` for suspicious files
- [ ] Review `git diff --cached` for hardcoded secrets

## ðŸš¨ If You Accidentally Commit Secrets

1. **Remove from latest commit:**
```bash
git rm --cached sensitive-file.txt
git commit --amend -m "Remove sensitive file"
```

2. **If already pushed:**
```bash
# Contact repository admin
# Consider the secret compromised
# Rotate credentials immediately
# Use git-filter-branch or BFG Repo-Cleaner to remove from history
```

3. **Rotate all compromised credentials:**
- Change database passwords
- Regenerate API keys
- Create new JWT secrets
- Update all deployments

## ðŸ“š Resources

- [GitHub's .gitignore templates](https://github.com/github/gitignore)
- [git-secrets tool](https://github.com/awslabs/git-secrets)
- [BFG Repo-Cleaner](https://rtyley.github.io/bfg-repo-cleaner/)
- [AWS Secrets Manager](https://aws.amazon.com/secrets-manager/)

---

**Last Updated:** October 16, 2025

**Note:** This checklist is automatically maintained. Update it whenever you add new sensitive file patterns to `.gitignore`.
